!function(w,doc){"use strict";var ARIAmodal={};(w.ARIAmodal=ARIAmodal).NS="ARIAmodal",ARIAmodal.AUTHOR="Scott O'Hara",ARIAmodal.VERSION="3.4.0",ARIAmodal.LICENSE="https://github.com/scottaohara/accessible_modal_window/blob/master/LICENSE";var initialTrigger,activeModal,body=doc.body,main=doc.getElementsByTagName("main")[0]||body,modal=doc.querySelectorAll("[data-modal]"),children=doc.querySelectorAll("body > *:not([data-modal])"),useAriaModal=!1,returnToBody=!1;ARIAmodal.organizeDOM=function(){var i,refEl=body.firstElementChild||null;for(i=0;i<modal.length;i+=1)body.insertBefore(modal[i],refEl)},ARIAmodal.setupTrigger=function(){var self,i,trigger=doc.querySelectorAll("[data-modal-open]");for(i=0;i<trigger.length;i+=1){var getOpenTarget=(self=trigger[i]).getAttribute("data-modal-open"),hasHref=self.getAttribute("href");if("BUTTON"!==self.nodeName)self.setAttribute("role","button"),self.tabIndex=0;if(""===getOpenTarget&&hasHref)self.setAttribute("data-modal-open",hasHref.split("#")[1]),getOpenTarget=hasHref.split("#")[1];if(self.removeAttribute("href"),getOpenTarget){if(self.hasAttribute("disabled")&&!self.hasAttribute("data-modal-disabled"))self.removeAttribute("disabled");self.removeAttribute("hidden"),self.addEventListener("click",ARIAmodal.openModal),self.addEventListener("keydown",ARIAmodal.keyEvents,!1)}else console.warn('Missing target modal dialog - [data-modal-open="IDREF"]')}},ARIAmodal.setupModal=function(){var i;for(i=0;i<modal.length;i+=1){var self,modalType=(self=modal[i]).getAttribute("data-modal"),getClass=self.getAttribute("data-modal-class")||"a11y-modal",heading=self.querySelector("h1, h2, h3, h4, h5, h6"),modalLabel=self.getAttribute("data-modal-label"),hideHeading=self.hasAttribute("data-modal-hide-heading"),modalDesc=self.querySelector("[data-modal-description]"),modalDoc=self.querySelector("[data-modal-document]");if("alert"===modalType)self.setAttribute("role","alertdialog");else self.setAttribute("role","dialog");if(self.classList.add(getClass),self.hidden=!0,self.tabIndex="-1",modalDoc)modalDoc.setAttribute("role","document");if(ARIAmodal.setupModalCloseBtn(self,getClass,modalType),self.hasAttribute("data-aria-modal"))self.setAttribute("aria-modal","true");if(modalDesc)modalDesc.id=modalDesc.id||"md_desc_"+Math.floor(999*Math.random())+1,self.setAttribute("aria-describedby",modalDesc.id);if(modalLabel)self.setAttribute("aria-label",modalLabel);else if(heading){var makeHeading=self.id+"_heading";if(heading.classList.add(getClass+"__heading"),heading.id=makeHeading,self.setAttribute("aria-labelledby",makeHeading),heading.hasAttribute("data-autofocus"))heading.tabIndex="-1"}else console.warn("Dialogs should have their purpose conveyed by a heading element (h1).");if(hideHeading)self.querySelector("#"+heading.id).classList.add("at-only");var focusable=self.querySelectorAll('button:not([hidden]):not([disabled]), [href]:not([hidden]), input:not([hidden]):not([type="hidden"]):not([disabled]), select:not([hidden]):not([disabled]), textarea:not([hidden]):not([disabled]), [tabindex="0"]:not([hidden]):not([disabled]), summary:not([hidden]), [contenteditable]:not([hidden]), audio[controls]:not([hidden]), video[controls]:not([hidden])');focusable[0].classList.add("js-first-focus"),focusable[focusable.length-1].classList.add("js-last-focus")}},ARIAmodal.setupModalCloseBtn=function(self,modalClass,modalType){var i,doNotGenerate=self.hasAttribute("data-modal-manual-close"),manualClose=self.querySelectorAll("[data-modal-close-btn]"),modalClose=self.getAttribute("data-modal-close"),modalCloseClass=self.getAttribute("data-modal-close-class");if(!doNotGenerate)if(manualClose.length<2){var closeBtn=doc.createElement("button");if(closeBtn.type="button",self.classList.add(modalClass),closeBtn.classList.add(modalClass+"__close-btn"),!modalClose&&"alert"!==modalType)closeBtn.innerHTML="<span data-modal-x></span>",closeBtn.setAttribute("aria-label","Close"),closeBtn.classList.add("is-icon-btn");else if(closeBtn.innerHTML=modalClose,modalCloseClass)closeBtn.classList.add(modalCloseClass);if("alert"!==modalType)if(self.querySelector('[role="document"]'))self.querySelector('[role="document"]').appendChild(closeBtn);else self.appendChild(closeBtn);closeBtn.addEventListener("click",ARIAmodal.closeModal)}for(i=0;i<manualClose.length;i+=1)manualClose[i].addEventListener("click",ARIAmodal.closeModal);doc.addEventListener("keydown",ARIAmodal.keyEvents,!1)},ARIAmodal.openModal=function(e,autoOpen){var i,getTargetModal=autoOpen||this.getAttribute("data-modal-open"),focusTarget=activeModal=doc.getElementById(getTargetModal),getAutofocus=activeModal.querySelector("[autofocus]")||activeModal.querySelector("[data-autofocus]"),setInert=activeModal.hasAttribute("data-coh-modal-overlay");if(useAriaModal=activeModal.hasAttribute("aria-modal"),autoOpen)returnToBody=!0;if(!autoOpen)e.preventDefault(),initialTrigger=this.id;if(getAutofocus)focusTarget=getAutofocus;else if(activeModal.hasAttribute("data-modal-close-focus"))focusTarget=activeModal.querySelector('[class*="close-btn"]');if(!body.classList.contains("modal-open")){if(body.classList.add("modal-open"),setInert)for(i=0;i<children.length;i+=1){if(!useAriaModal){if(children[i].hasAttribute("aria-hidden"))children[i].setAttribute("data-keep-hidden",children[i].getAttribute("aria-hidden"));children[i].setAttribute("aria-hidden","true")}if(children[i].getAttribute("inert"))children[i].setAttribute("data-keep-inert","");else children[i].setAttribute("inert","true")}}else console.warn("It is not advised to open dialogs from within other dialogs. Instead consider replacing the contents of this dialog with new content. Or providing a stepped, or tabbed interface within this dialog.");return activeModal.removeAttribute("hidden"),requestAnimationFrame(function(){focusTarget.focus()}),[initialTrigger,activeModal,returnToBody]},ARIAmodal.closeModal=function(e){var i,m,trigger=doc.getElementById(initialTrigger)||null;for(i=0;i<children.length;i+=1){if(!children[i].hasAttribute("data-keep-inert"))children[i].removeAttribute("inert");if(children[i].removeAttribute("data-keep-inert"),children[i].getAttribute("data-keep-hidden"))children[i].setAttribute("aria-hidden",children[i].getAttribute("data-keep-hidden"));else children[i].removeAttribute("aria-hidden");children[i].removeAttribute("data-keep-hidden")}for(body.classList.remove("modal-open"),m=0;m<modal.length;m+=1)if(!modal[m].hasAttribute("hidden"))modal[m].hidden=!0;if(null!==trigger)trigger.focus();else if(main&&!returnToBody)main.tabIndex=-1,main.focus();else body.tabIndex=-1,body.focus();return[initialTrigger=void 0,activeModal=void 0,returnToBody=!1]},ARIAmodal.keyEvents=function(e){var keyCode=e.keyCode||e.which;if(e.target.hasAttribute("data-modal-open"))switch(keyCode){case 13:case 32:e.preventDefault(),e.target.click()}if(body.classList.contains("modal-open")){switch(keyCode){case 27:ARIAmodal.closeModal()}if(body.classList.contains("modal-open"))var firstFocus=activeModal.querySelector(".js-first-focus"),lastFocus=activeModal.querySelector(".js-last-focus");if(doc.activeElement.classList.contains("js-last-focus"))if(9===keyCode&&!e.shiftKey)e.preventDefault(),firstFocus.focus();if(doc.activeElement.classList.contains("js-first-focus"))if(9===keyCode&&e.shiftKey)e.preventDefault(),lastFocus.focus()}},ARIAmodal.autoLoad=function(){var autoOpen,getAuto=doc.querySelectorAll("[data-modal-auto]"),hashValue=w.location.hash||null,useHash=!1;if(null!==hashValue)if(""===(autoOpen=hashValue.split("#")[1]))return!1;else if("!null"===autoOpen)return!1;else{var checkforDialog=doc.getElementById(autoOpen)||null;if(null!==checkforDialog)if("dialog"===checkforDialog.getAttribute("role")||"alertdialog"===checkforDialog.getAttribute("role"))useHash=!0}if(useHash){if(ARIAmodal.openModal(null,autoOpen),1<getAuto.length)console.warn("Only the modal indicated by the hash value will load.")}else if(0!==getAuto.length)if("dialog"===getAuto[0].getAttribute("role")||"alertdialog"===getAuto[0].getAttribute("role")){if(autoOpen=getAuto[0].id,ARIAmodal.openModal(null,autoOpen),1<getAuto.length)console.warn("Multiple modal dialogs can not auto load.")}else if("button"===getAuto[0].getAttribute("role")||"BUTTON"===getAuto[0].tagName)autoOpen=getAuto[0].id,getAuto[0].click();if(0!==getAuto.length&&!doc.getElementById(autoOpen).hasAttribute("data-modal-auto-persist"))w.location.replace("#!null")},ARIAmodal.init=function(){ARIAmodal.organizeDOM(),ARIAmodal.setupTrigger(),ARIAmodal.setupModal(),ARIAmodal.autoLoad()},ARIAmodal.init()}(window,document);
